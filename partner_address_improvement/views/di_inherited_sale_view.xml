<?xml version="1.0" encoding="UTF-8"?>
<odoo>       
	<!-- surcharge vue commande + lignes -->
	<record id="di_view_order_form" model="ir.ui.view">
		<field name="name">di.sale.order.form</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_order_form" />
		<field eval="80" name="priority" />
		<field name="arch" type="xml">
			<!-- on enlÃ¨ve les adresses du choix du tiers -->
			<xpath expr="//sheet/group/group/field[@name='partner_id']" position="replace">
				<field name="partner_id" widget="res_partner_many2one"
					context="{'res_partner_search_mode': 'customer', 'show_address': 1, 'show_vat': True}"
					options='{"always_reload": True}'
				 	domain="[('customer_rank','>',0),('parent_id','=',False),('type','=','contact')]"
				/>
			</xpath>
			<!-- pas les autres tiers, ni leurs adresses -->
			<xpath expr="//sheet/group/group/field[@name='partner_invoice_id']" position="replace">
				<field name="partner_invoice_id" groups="sale.group_delivery_invoice_address"
					context="{'default_type':'invoice', 'show_city' : 1}" options='{"always_reload": True}'
					domain="['|',('id','=',partner_id),('parent_id','=',partner_id)]"
				/>
			</xpath>
			<xpath expr="//sheet/group/group/field[@name='partner_shipping_id']" position="replace">
				<field name="partner_shipping_id" groups="sale.group_delivery_invoice_address"
					context="{'default_type':'delivery', 'show_city' : 1}" options='{"always_reload": True}'
					domain="['|',('id','=',partner_id),('parent_id','=',partner_id)]"
				/>
			</xpath>
		</field>
	</record>
</odoo>